# 2719. ç»Ÿè®¡æ•´æ•°æ•°ç›®

> [2719. ç»Ÿè®¡æ•´æ•°æ•°ç›®](https://leetcode.cn/problems/count-of-integers/)
>
> éš¾åº¦ï¼š<font color=red>`Hard`</font>
>
> æ ‡ç­¾ï¼š`æ•°å­¦` `å­—ç¬¦ä¸²` `åŠ¨æ€è§„åˆ’`

## é¢˜ç›®

ç»™ä½ ä¸¤ä¸ªæ•°å­—å­—ç¬¦ä¸² `num1` å’Œ `num2` ï¼Œä»¥åŠä¸¤ä¸ªæ•´æ•° `max_sum` å’Œ `min_sum` ã€‚å¦‚æœä¸€ä¸ªæ•´æ•° `x` æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œæˆ‘ä»¬ç§°å®ƒæ˜¯ä¸€ä¸ªå¥½æ•´æ•°ï¼š

* `num1 <= x <= num2`
* `min_sum <= digit_sum(x) <= max_sum`.

è¯·ä½ è¿”å›å¥½æ•´æ•°çš„æ•°ç›®ã€‚ç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œè¯·è¿”å›ç­”æ¡ˆå¯¹ `10<sup>9</sup> + 7` å–ä½™åçš„ç»“æœã€‚

æ³¨æ„ï¼Œ`digit_sum(x)` è¡¨ç¤º `x` å„ä½æ•°å­—ä¹‹å’Œã€‚

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šnum1 = "1", num2 = "12", min_num = 1, max_num = 8
è¾“å‡ºï¼š11
è§£é‡Šï¼šæ€»å…±æœ‰ 11 ä¸ªæ•´æ•°çš„æ•°ä½å’Œåœ¨ 1 åˆ° 8 ä¹‹é—´ï¼Œåˆ†åˆ«æ˜¯ 1,2,3,4,5,6,7,8,10,11 å’Œ 12 ã€‚æ‰€ä»¥æˆ‘ä»¬è¿”å› 11 ã€‚
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šnum1 = "1", num2 = "5", min_num = 1, max_num = 5
è¾“å‡ºï¼š5
è§£é‡Šï¼šæ•°ä½å’Œåœ¨ 1 åˆ° 5 ä¹‹é—´çš„ 5 ä¸ªæ•´æ•°åˆ†åˆ«ä¸º 1,2,3,4 å’Œ 5 ã€‚æ‰€ä»¥æˆ‘ä»¬è¿”å› 5 ã€‚
```

**æç¤ºï¼š**

* `1 <= num1 <= num2 <= 10^22`
* `1 <= min_sum <= max_sum <= 400`

--------------------

## é¢˜è§£

> <font color=red>ä¸ä¼šç›´æ¥çœ‹é¢˜è§£</font>
>
> å‚è€ƒï¼šhttps://leetcode.cn/problems/count-of-integers/solutions/2296043/shu-wei-dp-tong-yong-mo-ban-pythonjavacg-9tuc

**æ€è·¯**

å°†é—®é¢˜æ‹†åˆ†æˆï¼š

- è®¡ç®— â‰¤ num2 çš„å¥½æ•´æ•°ä¸ªæ•°ï¼Œè®°ä¸º a
- è®¡ç®— â‰¤ num1 - 1 çš„å¥½æ•´æ•°ä¸ªæ•°ï¼Œè®°ä¸º b

ç­”æ¡ˆå³ä¸º a - bã€‚å› ä¸º num1 æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ–¹ä¾¿å‡ä¸€ï¼Œæ”¹ä¸ºè®¡ç®— â‰¤ num1 çš„å¥½æ•´æ•°ä¸ªæ•°ï¼Œç„¶åå†åˆ¤æ–­ num1 æ˜¯å¦æ˜¯å¥½æ•´æ•°ã€‚

æ‰¾å¥½æ•´æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼Œæ•°ä½åŠ¨æ€è§„åˆ’ã€‚

æ•°ä½ dp å‚è€ƒé¢˜ç›® [1012. è‡³å°‘æœ‰ 1 ä½é‡å¤çš„æ•°å­—](https://leetcode.cn/problems/numbers-with-repeated-digits/description/) è¿›è¡Œç»ƒä¹ ã€‚

**ä»£ç **

```java
class Solution {
    public static final int MOD = 1_000_000_007;

    public int count(String num1, String num2, int min_sum, int max_sum) {
        // åˆ†åˆ«è®¡ç®— num2 å’Œ num1 çš„å¥½æ•´æ•°ä¸ªæ•°ï¼Œå·®å€¼å³ä¸º num1 - num2 ä¹‹é—´çš„å¥½æ•´æ•°ä¸ªæ•°ã€‚
        int ans = calc(num2, min_sum, max_sum) - calc(num1, min_sum, max_sum) + MOD;

        // åˆ¤æ–­ num1 æ˜¯å¦ä¸ºå¥½æ•´æ•°ï¼Œå¦‚æœæ˜¯åˆ™ç»“æœåŠ  1
        int sum = 0;
        for (char c : num1.toCharArray()) {
            sum += c - '0';
        }
        if (min_sum <= sum && sum <= max_sum) {
            ans++;
        }

        return ans % MOD;
    }

    private int calc(String s, int minSum, int maxSum) {
        int n = s.length();
        int[][] memo = new int[n][Math.min(n * 9, maxSum) + 1];
        for (int[] row : memo) {
            Arrays.fill(row, -1);
        }
        return dfs(0, 0, true, s.toCharArray(), minSum, maxSum, memo);
    }

    /**
     * i: å½“å‰å¤„ç†çš„æ•°ä½ç´¢å¼•
     * sum: i ä¹‹å‰çš„æ‰€æœ‰æ•°ä½å’Œ
     * isLimit: æ ‡è®°å‰ä¸€ä¸ªæ•°ä½æ˜¯å¦æ˜¯æå€¼
     */
    private int dfs(int i, int sum, boolean isLimit, char[] s, int minSum, int maxSum, int[][] memo) {
        if (sum > maxSum) {
            // æ•°ä½å’Œå·²ç»å¤§äºæœ€å¤§å€¼ï¼Œå½“å‰ä½ç½®å·²ç»ä¸ç”¨å¤„ç†äº†
            return 0;
        }
        if (i == s.length) {
            // å¾—åˆ°ä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ˜¯å¦å¤§äºç­‰äºæœ€å°å’Œè¦æ±‚
            return sum >= minSum ? 1 : 0;
        }
        if (!isLimit && memo[i][sum] != -1) {
            // å¦‚æœå‰ä¸€ä¸ªæ•°ä½çš„å€¼ä¸æ˜¯æå€¼ï¼Œç›´æ¥ä½¿ç”¨ä¹‹å‰å·²ç»æ‰¾åˆ°çš„ç»“æœ
            return memo[i][sum];
        }
        int up = isLimit ? s[i] - '0' : 9; // è·å–å½“å‰æ•°ä½çš„æœ€å¤§å€¼ï¼Œå¦‚æœå‰ä¸€ä¸ªæ•°ä¸ºå–çš„æ˜¯æå€¼ï¼Œå½“å‰æ•°ä½çš„æœ€å¤§å€¼ä¸º s[i] å¦åˆ™ä¸º 9
        int res = 0;
        for (int d = 0; d <= up; d++) { // æšä¸¾å½“å‰æ•°ä½çš„æ‰€æœ‰å¯èƒ½ç»“æœ
            res = (res + dfs(i + 1, sum + d, isLimit && (d == up), s, minSum, maxSum, memo)) % MOD;
        }
        if (!isLimit) {
            memo[i][sum] = res; // å¦‚æœå‰ä¸€ä¸ªæ•°ä½ä¸æ˜¯æå€¼ï¼Œå°†ç»“æœä¿å­˜ã€‚
        }
        return res;
    }
}
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(nmD)$ã€‚n ä¸º num2 çš„é•¿åº¦ï¼Œm = min(9n, max_sum)ï¼ŒD=10.
- ç©ºé—´å¤æ‚åº¦ï¼š$O(nm)$ã€‚

**ä¼˜åŒ–**

å°†ä¸¤æ¬¡è®°å¿†æœç´¢ä¼˜åŒ–æˆä¸€æ¬¡

```java
class Solution {
    public static final int MOD = 1_000_000_007;

    public int count(String num1, String num2, int min_sum, int max_sum) {
        int n = num2.length();
        num1 = "0".repeat(n - num1.length()) + num1; // è¡¥å‰å¯¼é›¶ï¼Œå’Œ num2 å¯¹é½
        int[][] memo = new int[n][Math.min(n * 9, max_sum) + 1];
        for (int[] row : memo) {
            Arrays.fill(row, -1);
        }
        return dfs(0, 0, true, true, num1.toCharArray(), num2.toCharArray(), min_sum, max_sum, memo);
    }

    /**
     * i: å½“å‰å¤„ç†çš„æ•°ä½ç´¢å¼•
     * sum: i ä¹‹å‰çš„æ‰€æœ‰æ•°ä½å’Œ
     * limitLow: æ ‡è®°å‰ä¸€ä¸ªæ•°ä½æ˜¯å¦æ˜¯æœ€å°å€¼
     * limitHigh: æ ‡è®°å‰ä¸€ä¸ªæ•°ä½æ˜¯å¦æ˜¯æœ€å¤§å€¼
     */
    private int dfs(int i, int sum, boolean limitLow, boolean limitHigh, char[] num1, char[] num2, int minSum, int maxSum, int[][] memo) {
        if (sum > maxSum) {
            // æ•°ä½å’Œå·²ç»å¤§äºæœ€å¤§å€¼ï¼Œå½“å‰ä½ç½®å·²ç»ä¸ç”¨å¤„ç†äº†
            return 0;
        }
        if (i == num2.length) {
            // å¾—åˆ°ä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ˜¯å¦å¤§äºç­‰äºæœ€å°å’Œè¦æ±‚
            return sum >= minSum ? 1 : 0;
        }
        if (!limitLow && !limitHigh && memo[i][sum] != -1) {
            // å¦‚æœå‰ä¸€ä¸ªæ•°ä½çš„å€¼ä¸æ˜¯æå€¼ï¼Œç›´æ¥ä½¿ç”¨ä¹‹å‰å·²ç»æ‰¾åˆ°çš„ç»“æœ
            return memo[i][sum];
        }
        int low = limitLow ? num1[i] - '0' : 0; // è·å–å½“å‰æ•°ä½çš„æœ€å°å€¼ï¼Œå¦‚æœå‰ä¸€ä¸ªæ•°ä¸ºå–çš„æ˜¯æœ€å°å€¼ï¼Œå½“å‰æ•°ä½çš„æœ€å°å€¼ä¸º s[i] å¦åˆ™ä¸º 0
        int high = limitHigh ? num2[i] - '0' : 9; // è·å–å½“å‰æ•°ä½çš„æœ€å¤§å€¼ï¼Œå¦‚æœå‰ä¸€ä¸ªæ•°ä¸ºå–çš„æ˜¯æœ€å¤§å€¼ï¼Œå½“å‰æ•°ä½çš„æœ€å¤§å€¼ä¸º s[i] å¦åˆ™ä¸º 9
        int res = 0;
        for (int d = low; d <= high; d++) { // æšä¸¾å½“å‰æ•°ä½çš„æ‰€æœ‰å¯èƒ½ç»“æœ
            res = (res + dfs(i + 1, sum + d, limitLow && (d == low), limitHigh && (d == high), num1, num2, minSum, maxSum, memo)) % MOD;
        }
        if (!limitLow && !limitHigh) {
            memo[i][sum] = res; // å¦‚æœå‰ä¸€ä¸ªæ•°ä½ä¸æ˜¯æå€¼ï¼Œå°†ç»“æœä¿å­˜ã€‚
        }
        return res;
    }
}
```

```js
/**
 * @param {string} num1
 * @param {string} num2
 * @param {number} min_sum
 * @param {number} max_sum
 * @return {number}
 */
var count = function (num1, num2, min_sum, max_sum) {
    num1 = '0'.repeat(num2.length - num1.length) + num1
    const memory = new Array(num2.length).fill().map(() => new Array(Math.min(num2.length * 9, max_sum) + 1).fill(-1))
    return dfs(0, 0, true, true, num1, num2, min_sum, max_sum, memory)
}

function dfs(i, sum, limitLow, limitHigh, num1, num2, minSum, maxSum, memory) {
    if (sum > maxSum) {
        return 0
    }
    if (i === num2.length) {
        return sum >= minSum ? 1 : 0
    }
    if (!limitHigh && !limitLow && memory[i][sum] !== -1) {
        return memory[i][sum]
    }

    const low = limitLow ? Number(num1[i]) : 0
    const high = limitHigh ? Number(num2[i]) : 9
    let ret = 0
    for (let d = low; d <= high; d++) {
        ret = (ret + dfs(i + 1, sum + d, limitLow && (d === low), limitHigh && (d === high), num1, num2, minSum, maxSum, memory)) % 1_000_000_007
    }

    if (!limitLow && !limitHigh) {
        memory[i][sum] = ret
    }

    return ret
}
```

> å‡­å€Ÿè®°å¿†ç”¨jså®ç°äº†ä¸€éï¼Œä½†æ˜¯è¿˜æ˜¯æ¼æ´ç™¾å‡ºï¼Œä»éœ€åŠªåŠ›ğŸ’ª
