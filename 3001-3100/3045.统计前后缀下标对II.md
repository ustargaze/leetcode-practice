# 3045. ç»Ÿè®¡å‰åç¼€ä¸‹æ ‡å¯¹ II

> [3045. ç»Ÿè®¡å‰åç¼€ä¸‹æ ‡å¯¹ II](https://leetcode.cn/problems/count-prefix-and-suffix-pairs-ii/)
>
> éš¾åº¦ï¼š<font color=red>`Hard`</font>
>
> æ ‡ç­¾ï¼š`å­—å…¸æ ‘` `æ•°ç»„` `å­—ç¬¦ä¸²` `å­—ç¬¦ä¸²åŒ¹é…` `å“ˆå¸Œå‡½æ•°` `æ»šåŠ¨å“ˆå¸Œ`

## é¢˜ç›®

<p>ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» <strong>0</strong> å¼€å§‹çš„å­—ç¬¦ä¸²æ•°ç»„ <code>words</code> ã€‚</p>

<p>å®šä¹‰ä¸€ä¸ª <strong>å¸ƒå°” </strong>å‡½æ•° <code>isPrefixAndSuffix</code> ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå­—ç¬¦ä¸²å‚æ•° <code>str1</code> å’Œ <code>str2</code> ï¼š</p>

<ul>
	<li>å½“ <code>str1</code> åŒæ—¶æ˜¯ <code>str2</code> çš„å‰ç¼€ï¼ˆ<span data-keyword="string-prefix">prefix</span>ï¼‰å’Œåç¼€ï¼ˆ<span data-keyword="string-suffix">suffix</span>ï¼‰æ—¶ï¼Œ<code>isPrefixAndSuffix(str1, str2)</code> è¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</li>
</ul>

<p>ä¾‹å¦‚ï¼Œ<code>isPrefixAndSuffix("aba", "ababa")</code> è¿”å› <code>true</code>ï¼Œå› ä¸º <code>"aba"</code> æ—¢æ˜¯ <code>"ababa"</code> çš„å‰ç¼€ï¼Œä¹Ÿæ˜¯ <code>"ababa"</code> çš„åç¼€ï¼Œä½†æ˜¯ <code>isPrefixAndSuffix("abc", "abcd")</code> è¿”å›<code> false</code>ã€‚</p>

<p>ä»¥æ•´æ•°å½¢å¼ï¼Œè¿”å›æ»¡è¶³ <code>i &lt; j</code> ä¸” <code>isPrefixAndSuffix(words[i], words[j])</code> ä¸º <code>true</code> çš„ä¸‹æ ‡å¯¹ <code>(i, j)</code> çš„<strong> æ•°é‡ </strong>ã€‚</p>

<p>&nbsp;</p>

<p><strong class="example">ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>words = ["a","aba","ababa","aa"]
<strong>è¾“å‡ºï¼š</strong>4
<strong>è§£é‡Šï¼š</strong>åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œè®¡æ•°çš„ä¸‹æ ‡å¯¹åŒ…æ‹¬ï¼š
i = 0 ä¸” j = 1 ï¼Œå› ä¸º isPrefixAndSuffix("a", "aba") ä¸º true ã€‚
i = 0 ä¸” j = 2 ï¼Œå› ä¸º isPrefixAndSuffix("a", "ababa") ä¸º true ã€‚
i = 0 ä¸” j = 3 ï¼Œå› ä¸º isPrefixAndSuffix("a", "aa") ä¸º true ã€‚
i = 1 ä¸” j = 2 ï¼Œå› ä¸º isPrefixAndSuffix("aba", "ababa") ä¸º true ã€‚
å› æ­¤ï¼Œç­”æ¡ˆæ˜¯ 4 ã€‚</pre>

<p><strong class="example">ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>words = ["pa","papa","ma","mama"]
<strong>è¾“å‡ºï¼š</strong>2
<strong>è§£é‡Šï¼š</strong>åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œè®¡æ•°çš„ä¸‹æ ‡å¯¹åŒ…æ‹¬ï¼š
i = 0 ä¸” j = 1 ï¼Œå› ä¸º isPrefixAndSuffix("pa", "papa") ä¸º true ã€‚
i = 2 ä¸” j = 3 ï¼Œå› ä¸º isPrefixAndSuffix("ma", "mama") ä¸º true ã€‚
å› æ­¤ï¼Œç­”æ¡ˆæ˜¯ 2 ã€‚</pre>

<p><strong class="example">ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>words = ["abab","ab"]
<strong>è¾“å‡ºï¼š</strong>0
<strong>è§£é‡Šï¼š</strong>åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œå”¯ä¸€æœ‰æ•ˆçš„ä¸‹æ ‡å¯¹æ˜¯ i = 0 ä¸” j = 1 ï¼Œä½†æ˜¯ isPrefixAndSuffix("abab", "ab") ä¸º false ã€‚
å› æ­¤ï¼Œç­”æ¡ˆæ˜¯ 0 ã€‚</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= words.length &lt;= 10<sup>5</sup></code></li>
	<li><code>1 &lt;= words[i].length &lt;= 10<sup>5</sup></code></li>
	<li><code>words[i]</code> ä»…ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆã€‚</li>
	<li>æ‰€æœ‰ <code>words[i]</code> çš„é•¿åº¦ä¹‹å’Œä¸è¶…è¿‡ <code>5 * 10<sup>5</sup></code> ã€‚</li>
</ul>


--------------------

## é¢˜è§£

### æ–¹æ³•ä¸€ï¼šå­—å…¸æ ‘

**æ€è·¯**

å‚è€ƒï¼šhttps://leetcode.cn/problems/count-prefix-and-suffix-pairs-ii/solutions/2644160/z-han-shu-zi-dian-shu-pythonjavacgo-by-e-5c2v

**ä»£ç **

```java
class Node {
    Map<Integer, Node> son = new HashMap<>();
    int cnt;
}

class Solution {
    public long countPrefixSuffixPairs(String[] words) {
        long ans = 0;
        Node root = new Node();
        for (String S : words) {
            char[] s = S.toCharArray();
            int n = s.length;
            Node cur = root;
            for (int i = 0; i < n; i++) {
                int p = (s[i] - 'a') << 5 | (s[n - 1 - i] - 'a');
                cur = cur.son.computeIfAbsent(p, k -> new Node());
                ans += cur.cnt;
            }
            cur.cnt++;
        }
        return ans;
    }
}
```



### æ–¹æ³•äºŒ

è¿™åº”è¯¥ç®—æš´åŠ›ç ´è§£å§ğŸ¥¶ï¼Œè·‘çš„è¿˜æŒºå¿«ã€‚

```java
class Solution {
    public long countPrefixSuffixPairs(String[] words) {
        int n = words.length;
        long ans = 0;
        Map<String, Integer> cnt = new HashMap<>();
        for (String s : words) {
            for (String k : cnt.keySet()) {
                if (s.startsWith(k) && s.endsWith(k)) {
                    ans += cnt.get(k);
                }
            }
            cnt.merge(s, 1, Integer::sum);
        }
        return ans;
    }
}
```

