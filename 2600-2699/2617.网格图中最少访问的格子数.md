# 2617. ç½‘æ ¼å›¾ä¸­æœ€å°‘è®¿é—®çš„æ ¼å­æ•°

> [2617. ç½‘æ ¼å›¾ä¸­æœ€å°‘è®¿é—®çš„æ ¼å­æ•°](https://leetcode.cn/problems/minimum-number-of-visited-cells-in-a-grid/)
>
> éš¾åº¦ï¼š<font color=red>`Hard`</font>
>
> æ ‡ç­¾ï¼š`æ ˆ` `å¹¿åº¦ä¼˜å…ˆæœç´¢` `å¹¶æŸ¥é›†` `æ•°ç»„` `åŠ¨æ€è§„åˆ’` `çŸ©é˜µ` `å•è°ƒæ ˆ` `å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`

## é¢˜ç›®

<p>ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» <strong>0</strong>&nbsp;å¼€å§‹çš„&nbsp;<code>m x n</code>&nbsp;æ•´æ•°çŸ©é˜µ&nbsp;<code>grid</code>&nbsp;ã€‚ä½ ä¸€å¼€å§‹çš„ä½ç½®åœ¨&nbsp;<strong>å·¦ä¸Šè§’</strong>&nbsp;æ ¼å­&nbsp;<code>(0, 0)</code>&nbsp;ã€‚</p>

<p>å½“ä½ åœ¨æ ¼å­&nbsp;<code>(i, j)</code>&nbsp;çš„æ—¶å€™ï¼Œä½ å¯ä»¥ç§»åŠ¨åˆ°ä»¥ä¸‹æ ¼å­ä¹‹ä¸€ï¼š</p>

<ul>
	<li>æ»¡è¶³ <code>j &lt; k &lt;= grid[i][j] + j</code>&nbsp;çš„æ ¼å­&nbsp;<code>(i, k)</code>&nbsp;ï¼ˆå‘å³ç§»åŠ¨ï¼‰ï¼Œæˆ–è€…</li>
	<li>æ»¡è¶³ <code>i &lt; k &lt;= grid[i][j] + i</code>&nbsp;çš„æ ¼å­&nbsp;<code>(k, j)</code>&nbsp;ï¼ˆå‘ä¸‹ç§»åŠ¨ï¼‰ã€‚</li>
</ul>

<p>è¯·ä½ è¿”å›åˆ°è¾¾ <strong>å³ä¸‹è§’</strong>&nbsp;æ ¼å­&nbsp;<code>(m - 1, n - 1)</code>&nbsp;éœ€è¦ç»è¿‡çš„æœ€å°‘ç§»åŠ¨æ ¼å­æ•°ï¼Œå¦‚æœæ— æ³•åˆ°è¾¾å³ä¸‹è§’æ ¼å­ï¼Œè¯·ä½ è¿”å›&nbsp;<code>-1</code>&nbsp;ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode.com/uploads/2023/01/25/ex1.png" style="width: 271px; height: 171px;"></p>

<pre><b>è¾“å…¥ï¼š</b>grid = [[3,4,2,1],[4,2,3,1],[2,1,0,0],[2,4,0,0]]
<b>è¾“å‡ºï¼š</b>4
<b>è§£é‡Šï¼š</b>ä¸Šå›¾å±•ç¤ºäº†åˆ°è¾¾å³ä¸‹è§’æ ¼å­ç»è¿‡çš„ 4 ä¸ªæ ¼å­ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode.com/uploads/2023/01/25/ex2.png" style="width: 271px; height: 171px;"></p>

<pre><b>è¾“å…¥ï¼š</b>grid = [[3,4,2,1],[4,2,1,1],[2,1,1,0],[3,4,1,0]]
<b>è¾“å‡ºï¼š</b>3
<strong>è§£é‡Šï¼š</strong>ä¸Šå›¾å±•ç¤ºäº†åˆ°è¾¾å³ä¸‹è§’æ ¼å­ç»è¿‡çš„ 3 ä¸ªæ ¼å­ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode.com/uploads/2023/01/26/ex3.png" style="width: 181px; height: 81px;"></p>

<pre><b>è¾“å…¥ï¼š</b>grid = [[2,1,0],[1,0,0]]
<b>è¾“å‡ºï¼š</b>-1
<b>è§£é‡Šï¼š</b>æ— æ³•åˆ°è¾¾å³ä¸‹è§’æ ¼å­ã€‚
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>m == grid.length</code></li>
	<li><code>n == grid[i].length</code></li>
	<li><code>1 &lt;= m, n &lt;= 10<sup>5</sup></code></li>
	<li><code>1 &lt;= m * n &lt;= 10<sup>5</sup></code></li>
	<li><code>0 &lt;= grid[i][j] &lt; m * n</code></li>
	<li><code>grid[m - 1][n - 1] == 0</code></li>
</ul>


--------------------

## é¢˜è§£

åªèƒ½æƒ³åˆ°ä½¿ç”¨æš´åŠ›çš„ BFS æˆ–è€… DFSï¼Œå¤æ‚åº¦å¤ªé«˜ä¼šè¶…æ—¶ï¼Œæƒ³ä¸åˆ°ä¼˜åŒ–çš„æ–¹æ³•ğŸ¤ªï¼Œå…ˆè®°å½•ä¸€ä¸ªé¢˜è§£ï¼Œä¸‹æ¬¡å¤ä¹ æ—¶å†æ¥å†å‰ã€‚

### æ–¹æ³•ä¸€ï¼š

**æ€è·¯**

å‚è€ƒï¼šhttps://leetcode.cn/problems/minimum-number-of-visited-cells-in-a-grid/solutions/2216329/dan-diao-zhan-you-hua-dp-by-endlesscheng-mc50

**ä»£ç **

```java
class Solution {
    public int minimumVisitedCells(int[][] grid) {
        int m = grid.length;
        int n = grid[0].length;
        int f = 0;
        PriorityQueue<int[]>[] colHeaps = new PriorityQueue[n]; // æ¯ä¸€åˆ—çš„æœ€å°å †
        Arrays.setAll(colHeaps, i -> new PriorityQueue<int[]>(Comparator.comparingInt(a -> a[0])));
        PriorityQueue<int[]> rowH = new PriorityQueue<>(Comparator.comparingInt(a -> a[0])); // è¡Œæœ€å°å †
        for (int i = 0; i < m; i++) {
            rowH.clear();
            for (int j = 0; j < n; j++) {
                while (!rowH.isEmpty() && rowH.peek()[1] < j) { // æ— æ³•åˆ°è¾¾ç¬¬ j åˆ—
                    rowH.poll(); // å¼¹å‡ºæ— ç”¨æ•°æ®
                }
                PriorityQueue<int[]> colH = colHeaps[j];
                while (!colH.isEmpty() && colH.peek()[1] < i) { // æ— æ³•åˆ°è¾¾ç¬¬ i è¡Œ
                    colH.poll(); // å¼¹å‡ºæ— ç”¨æ•°æ®
                }

                f = i > 0 || j > 0 ? Integer.MAX_VALUE : 1; // èµ·ç‚¹ç®— 1 ä¸ªæ ¼å­
                if (!rowH.isEmpty()) {
                    f = rowH.peek()[0] + 1; // ä»å·¦è¾¹è·³è¿‡æ¥
                }
                if (!colH.isEmpty()) {
                    f = Math.min(f, colH.peek()[0] + 1); // ä»ä¸Šè¾¹è·³è¿‡æ¥
                }

                int g = grid[i][j];
                if (g > 0 && f < Integer.MAX_VALUE) {
                    rowH.offer(new int[]{f, g + j}); // ç»è¿‡çš„æ ¼å­æ•°ï¼Œå‘å³æœ€è¿œèƒ½åˆ°è¾¾çš„åˆ—å·
                    colH.offer(new int[]{f, g + i}); // ç»è¿‡çš„æ ¼å­æ•°ï¼Œå‘ä¸‹æœ€è¿œèƒ½åˆ°è¾¾çš„è¡Œå·
                }
            }
        }
        return f < Integer.MAX_VALUE ? f : -1; // æ­¤æ—¶çš„ f æ˜¯åœ¨ (m-1, n-1) å¤„ç®—å‡ºæ¥çš„
    }
}
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(mn(\log m + \log n))$ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼š$O(mn)$ã€‚
